<!DOCTYPE html>

<html lang="es" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>vendedores &#8212; documentación de PROYECTODAM24_25 - v.0.0.1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=12dfc556" />
    <script src="../_static/documentation_options.js?v=8ee129b9"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/translations.js?v=d190bf04"></script>
    <link rel="index" title="Índice" href="../genindex.html" />
    <link rel="search" title="Búsqueda" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Código fuente para vendedores</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span><span class="w"> </span><span class="nn">eventos</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">var</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PyQt6</span><span class="w"> </span><span class="kn">import</span> <span class="n">QtWidgets</span><span class="p">,</span> <span class="n">QtCore</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>


<div class="viewcode-block" id="Vendedores">
<a class="viewcode-back" href="../src/vendedores.html#vendedores.Vendedores">[documentos]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Vendedores</span><span class="p">():</span>

<div class="viewcode-block" id="Vendedores.checkDniVen">
<a class="viewcode-back" href="../src/vendedores.html#vendedores.Vendedores.checkDniVen">[documentos]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">checkDniVen</span><span class="p">(</span><span class="n">dni</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Verifica la validez del DNI del vendedor y actualiza el campo de texto correspondiente.</span>

<span class="sd">            Procedimiento:</span>
<span class="sd">            1. Convierte el DNI a mayúsculas y lo establece en el campo de texto.</span>
<span class="sd">            2. Verifica si el DNI es válido.</span>
<span class="sd">            3. Si el DNI es válido, cambia el estilo del campo de texto a verde.</span>
<span class="sd">            4. Si el DNI no es válido, cambia el estilo del campo de texto a rojo, borra el contenido y establece un texto de marcador de posición.</span>

<span class="sd">            Excepciones:</span>
<span class="sd">            - Captura y muestra cualquier excepción que ocurra durante el proceso de verificación.</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dni</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">dni</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
            <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtDniVen</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">dni</span><span class="p">))</span>
            <span class="n">check</span> <span class="o">=</span> <span class="n">eventos</span><span class="o">.</span><span class="n">Eventos</span><span class="o">.</span><span class="n">isDniValido</span><span class="p">(</span><span class="n">dni</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">check</span><span class="p">:</span>
                <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtDniVen</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s1">&#39;border: 1px solid #41AD48; border-radius: 5px;&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtDniVen</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s1">&#39;border: 1px solid #de6767; border-radius: 5px; font-style: italic;&#39;</span><span class="p">)</span>
                <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtDniVen</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtDniVen</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="s2">&quot;dni no válido&quot;</span><span class="p">)</span>
                <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtDniVen</span><span class="o">.</span><span class="n">setFocus</span><span class="p">()</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error check clientes&quot;</span> <span class="o">+</span> <span class="n">e</span><span class="p">)</span></div>


<div class="viewcode-block" id="Vendedores.checkMovilVen">
<a class="viewcode-back" href="../src/vendedores.html#vendedores.Vendedores.checkMovilVen">[documentos]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">checkMovilVen</span><span class="p">(</span><span class="n">movil</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                Verifica la validez del número de móvil del vendedor y actualiza el campo de texto correspondiente.</span>

<span class="sd">                Procedimiento:</span>
<span class="sd">                1. Verifica si el número de móvil es válido.</span>
<span class="sd">                2. Si el número de móvil es válido, cambia el estilo del campo de texto a blanco.</span>
<span class="sd">                3. Si el número de móvil no es válido, cambia el estilo del campo de texto a rojo, borra el contenido y establece un texto de marcador de posición.</span>

<span class="sd">                Excepciones:</span>
<span class="sd">                - Captura y muestra cualquier excepción que ocurra durante el proceso de verificación.</span>
<span class="sd">                &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">eventos</span><span class="o">.</span><span class="n">Eventos</span><span class="o">.</span><span class="n">isMovilValido</span><span class="p">(</span><span class="n">movil</span><span class="p">):</span>
                <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtMovilVen</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s1">&#39;background-color: rgb(255, 255, 255);&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtMovilVen</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s1">&#39;border: 1px solid #de6767; border-radius: 5px; font-style: italic;&#39;</span><span class="p">)</span>
                <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtMovilVen</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtMovilVen</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="s2">&quot;móvil no válido&quot;</span><span class="p">)</span>
                <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtMovilVen</span><span class="o">.</span><span class="n">setFocus</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error check movil&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span></div>


<div class="viewcode-block" id="Vendedores.checkEmailVen">
<a class="viewcode-back" href="../src/vendedores.html#vendedores.Vendedores.checkEmailVen">[documentos]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">checkEmailVen</span><span class="p">(</span><span class="n">mail</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Verifica la validez del correo electrónico del vendedor y actualiza el campo de texto correspondiente.</span>

<span class="sd">            Procedimiento:</span>
<span class="sd">            1. Verifica si el correo electrónico es válido.</span>
<span class="sd">            2. Si el correo electrónico es válido, cambia el estilo del campo de texto a blanco y lo establece en minúsculas.</span>
<span class="sd">            3. Si el correo electrónico no es válido, cambia el estilo del campo de texto a rojo, borra el contenido y establece un texto de marcador de posición.</span>

<span class="sd">            Excepciones:</span>
<span class="sd">            - Captura y muestra cualquier excepción que ocurra durante el proceso de verificación.</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">eventos</span><span class="o">.</span><span class="n">Eventos</span><span class="o">.</span><span class="n">isMailValido</span><span class="p">(</span><span class="n">mail</span><span class="p">):</span>
                <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtEmailVen</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s1">&#39;background-color: rgb(255, 255, 255);&#39;</span><span class="p">)</span>
                <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtEmailVen</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">mail</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtEmailVen</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s1">&#39;border: 1px solid #de6767; border-radius: 5px; font-style: italic;&#39;</span><span class="p">)</span>
                <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtEmailVen</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtEmailVen</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="s2">&quot;correo no válido&quot;</span><span class="p">)</span>
                <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtEmailVen</span><span class="o">.</span><span class="n">setFocus</span><span class="p">()</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error check email&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span></div>


<div class="viewcode-block" id="Vendedores.altaVendedor">
<a class="viewcode-back" href="../src/vendedores.html#vendedores.Vendedores.altaVendedor">[documentos]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">altaVendedor</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                Da de alta a un nuevo vendedor en la base de datos y actualiza la tabla de vendedores.</span>

<span class="sd">                Procedimiento:</span>
<span class="sd">                1. Obtiene los datos del nuevo vendedor desde la interfaz de usuario.</span>
<span class="sd">                2. Verifica si el vendedor ya está presente en la base de datos.</span>
<span class="sd">                3. Si el vendedor ya existe, muestra un mensaje de error.</span>
<span class="sd">                4. Si los campos obligatorios están completos y el vendedor no existe, lo da de alta en la base de datos.</span>
<span class="sd">                5. Si los campos obligatorios no están completos, muestra un mensaje de error.</span>
<span class="sd">                6. Si ocurre algún error durante el proceso, muestra un mensaje de error.</span>

<span class="sd">                Excepciones:</span>
<span class="sd">                - Captura y muestra cualquier excepción que ocurra durante el proceso de alta del vendedor.</span>
<span class="sd">                &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">nuevoVendedor</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtDniVen</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span><span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtNomVen</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span><span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtAltaVen</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span><span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtMovilVen</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span><span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtEmailVen</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span><span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">cmbDeleVen</span><span class="o">.</span><span class="n">currentText</span><span class="p">()]</span>

            <span class="k">if</span> <span class="n">Vendedores</span><span class="o">.</span><span class="n">isVendedorPresent</span><span class="p">(</span><span class="n">nuevoVendedor</span><span class="p">):</span>
                <span class="n">eventos</span><span class="o">.</span><span class="n">Eventos</span><span class="o">.</span><span class="n">crearMensajeError</span><span class="p">(</span><span class="s2">&quot;Error&quot;</span><span class="p">,</span><span class="s2">&quot;El DNI del vendedor introducido ya existe&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">Vendedores</span><span class="o">.</span><span class="n">hasCamposObligatorios</span><span class="p">(</span><span class="n">nuevoVendedor</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">Vendedores</span><span class="o">.</span><span class="n">isVendedorPresent</span><span class="p">(</span><span class="n">nuevoVendedor</span><span class="p">)</span> <span class="ow">and</span> <span class="n">var</span><span class="o">.</span><span class="n">claseConexion</span><span class="o">.</span><span class="n">altaVendedor</span><span class="p">(</span><span class="n">nuevoVendedor</span><span class="p">):</span>
                <span class="n">eventos</span><span class="o">.</span><span class="n">Eventos</span><span class="o">.</span><span class="n">crearMensajeInfo</span><span class="p">(</span><span class="s2">&quot;Aviso&quot;</span><span class="p">,</span><span class="s2">&quot;Vendedor dado de alta en Base de Datos&quot;</span><span class="p">)</span>
                <span class="n">Vendedores</span><span class="o">.</span><span class="n">cargaTablaVendedores</span><span class="p">()</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">Vendedores</span><span class="o">.</span><span class="n">hasCamposObligatorios</span><span class="p">(</span><span class="n">nuevoVendedor</span><span class="p">):</span>
                <span class="n">eventos</span><span class="o">.</span><span class="n">Eventos</span><span class="o">.</span><span class="n">crearMensajeError</span><span class="p">(</span><span class="s2">&quot;Error&quot;</span><span class="p">,</span><span class="s2">&quot;Algunos campos deben ser cubiertos.&quot;</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">eventos</span><span class="o">.</span><span class="n">Eventos</span><span class="o">.</span><span class="n">crearMensajeError</span><span class="p">(</span><span class="s2">&quot;Error&quot;</span><span class="p">,</span><span class="s2">&quot;Error al grabar vendedor.&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error alta vendedor&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span></div>


<div class="viewcode-block" id="Vendedores.hasCamposObligatorios">
<a class="viewcode-back" href="../src/vendedores.html#vendedores.Vendedores.hasCamposObligatorios">[documentos]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">hasCamposObligatorios</span><span class="p">(</span><span class="n">nuevoVendedor</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                Verifica si los campos obligatorios del nuevo vendedor están completos.</span>

<span class="sd">                Procedimiento:</span>
<span class="sd">                1. Crea una copia de la lista de datos del nuevo vendedor.</span>
<span class="sd">                2. Elimina los campos de fecha de alta y correo electrónico de la lista.</span>
<span class="sd">                3. Recorre los datos restantes y verifica si alguno está vacío o es None.</span>
<span class="sd">                4. Si algún campo está vacío o es None, retorna False.</span>
<span class="sd">                5. Si todos los campos están completos, retorna True.</span>

<span class="sd">                Parámetros:</span>
<span class="sd">                - nuevoVendedor: Lista con los datos del nuevo vendedor.</span>

<span class="sd">                Retorna:</span>
<span class="sd">                - True si todos los campos obligatorios están completos, False en caso contrario.</span>
<span class="sd">                &quot;&quot;&quot;</span>
        <span class="n">datos</span> <span class="o">=</span> <span class="n">nuevoVendedor</span><span class="p">[:]</span>
        <span class="n">fecha_alta</span> <span class="o">=</span> <span class="n">datos</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">mail</span> <span class="o">=</span> <span class="n">datos</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">dato</span> <span class="ow">in</span> <span class="n">datos</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">dato</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="n">dato</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="Vendedores.isVendedorPresent">
<a class="viewcode-back" href="../src/vendedores.html#vendedores.Vendedores.isVendedorPresent">[documentos]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">isVendedorPresent</span><span class="p">(</span><span class="n">nuevoVendedor</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Verifica si un vendedor ya está presente en la base de datos.</span>

<span class="sd">            Procedimiento:</span>
<span class="sd">            1. Obtiene los datos del vendedor a partir del DNI.</span>
<span class="sd">            2. Si el registro no está vacío, retorna True.</span>
<span class="sd">            3. Si el registro está vacío, retorna False.</span>

<span class="sd">            Parámetros:</span>
<span class="sd">            - nuevoVendedor: Lista con los datos del nuevo vendedor.</span>

<span class="sd">            Retorna:</span>
<span class="sd">            - True si el vendedor ya está presente, False en caso contrario.</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="n">registro</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">claseConexion</span><span class="o">.</span><span class="n">datosOneVendedor</span><span class="p">(</span><span class="n">nuevoVendedor</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;dniVendedor&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">registro</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="Vendedores.cargaTablaVendedores">
<a class="viewcode-back" href="../src/vendedores.html#vendedores.Vendedores.cargaTablaVendedores">[documentos]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">cargaTablaVendedores</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Carga la tabla de vendedores con los datos obtenidos de la base de datos.</span>

<span class="sd">            Procedimiento:</span>
<span class="sd">            1. Obtiene el listado de vendedores desde la base de datos.</span>
<span class="sd">            2. Configura el número de filas de la tabla según el número de vendedores.</span>
<span class="sd">            3. Rellena la tabla con los datos de los vendedores.</span>
<span class="sd">            4. Ajusta la alineación del texto en las celdas de la tabla.</span>

<span class="sd">            Excepciones:</span>
<span class="sd">            - Captura y muestra cualquier excepción que ocurra durante el proceso de carga de la tabla.</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">listado</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">claseConexion</span><span class="o">.</span><span class="n">listadoVendedores</span><span class="p">()</span>

            <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">tablaVendedores</span><span class="o">.</span><span class="n">setRowCount</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">listado</span><span class="p">))</span>
            <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">registro</span> <span class="ow">in</span> <span class="n">listado</span><span class="p">:</span>
                <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">tablaVendedores</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">registro</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span> <span class="c1">#id</span>
                <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">tablaVendedores</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">registro</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span> <span class="c1">#nombre</span>
                <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">tablaVendedores</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">registro</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="p">))</span> <span class="c1">#movil</span>
                <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">tablaVendedores</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">registro</span><span class="p">[</span><span class="mi">7</span><span class="p">]))</span> <span class="c1">#movil</span>
                <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">tablaVendedores</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">registro</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span> <span class="c1">#baja</span>
                <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">tablaVendedores</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">setTextAlignment</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
                <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">tablaVendedores</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">setTextAlignment</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignLeft</span><span class="o">.</span><span class="n">AlignVCenter</span><span class="p">)</span>
                <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">tablaVendedores</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">setTextAlignment</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignLeft</span><span class="o">.</span><span class="n">AlignVCenter</span><span class="p">)</span>
                <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">tablaVendedores</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">setTextAlignment</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignLeft</span><span class="o">.</span><span class="n">AlignVCenter</span><span class="p">)</span>
                <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">tablaVendedores</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">setTextAlignment</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
                <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>


        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error cargaVendedor en cargaTablaVendedores&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span></div>


<div class="viewcode-block" id="Vendedores.bajaVendedor">
<a class="viewcode-back" href="../src/vendedores.html#vendedores.Vendedores.bajaVendedor">[documentos]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">bajaVendedor</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Da de baja a un vendedor en la base de datos y actualiza la tabla de vendedores.</span>

<span class="sd">            Procedimiento:</span>
<span class="sd">            1. Obtiene el DNI del vendedor desde la interfaz de usuario.</span>
<span class="sd">            2. Intenta dar de baja al vendedor en la base de datos.</span>
<span class="sd">            3. Si la baja es exitosa, muestra un mensaje de confirmación y actualiza la tabla de vendedores.</span>
<span class="sd">            4. Si el vendedor no existe o ya ha sido dado de baja, muestra un mensaje de error.</span>

<span class="sd">            Excepciones:</span>
<span class="sd">            - Captura y muestra cualquier excepción que ocurra durante el proceso de baja del vendedor.</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dni</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtDniVen</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">claseConexion</span><span class="o">.</span><span class="n">bajaVendedor</span><span class="p">(</span><span class="n">dni</span><span class="p">):</span>
                <span class="n">eventos</span><span class="o">.</span><span class="n">Eventos</span><span class="o">.</span><span class="n">crearMensajeInfo</span><span class="p">(</span><span class="s2">&quot;Aviso&quot;</span><span class="p">,</span><span class="s2">&quot;El vendedor fue dado de baja a fecha de: &quot;</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">/%m/%Y&quot;</span><span class="p">))</span>
                <span class="n">Vendedores</span><span class="o">.</span><span class="n">cargaTablaVendedores</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">eventos</span><span class="o">.</span><span class="n">Eventos</span><span class="o">.</span><span class="n">crearMensajeError</span><span class="p">(</span><span class="s2">&quot;Error&quot;</span><span class="p">,</span><span class="s2">&quot;El vendedor no existe o ya ha sido dado de baja.&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error al dar de baja vendedor&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span></div>


<div class="viewcode-block" id="Vendedores.cargaOneVendedor">
<a class="viewcode-back" href="../src/vendedores.html#vendedores.Vendedores.cargaOneVendedor">[documentos]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">cargaOneVendedor</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Carga los datos de un vendedor seleccionado en la interfaz de usuario.</span>

<span class="sd">            Procedimiento:</span>
<span class="sd">            1. Obtiene la fila seleccionada en la tabla de vendedores.</span>
<span class="sd">            2. Extrae los datos de la fila seleccionada.</span>
<span class="sd">            3. Obtiene los datos completos del vendedor desde la base de datos usando el DNI.</span>
<span class="sd">            4. Asigna los datos obtenidos a los campos correspondientes en la interfaz de usuario.</span>
<span class="sd">            5. Establece el ID del vendedor en el campo de texto correspondiente.</span>
<span class="sd">            6. Establece el ID del vendedor en el campo de texto de alquileres.</span>

<span class="sd">            Excepciones:</span>
<span class="sd">            - Captura y muestra cualquier excepción que ocurra durante el proceso de carga de datos del vendedor.</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">fila</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">tablaVendedores</span><span class="o">.</span><span class="n">selectedItems</span><span class="p">()</span>
            <span class="n">datos</span> <span class="o">=</span> <span class="p">[</span><span class="n">dato</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="k">for</span> <span class="n">dato</span> <span class="ow">in</span> <span class="n">fila</span><span class="p">]</span>
            <span class="n">registro</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">claseConexion</span><span class="o">.</span><span class="n">datosOneVendedor</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">datos</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">listado</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">lblIdVen</span><span class="p">,</span><span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtDniVen</span><span class="p">,</span> <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtNomVen</span><span class="p">,</span> <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtAltaVen</span><span class="p">,</span> <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtBajaVen</span><span class="p">,</span>
                       <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtMovilVen</span><span class="p">,</span> <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtEmailVen</span><span class="p">,</span> <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">cmbDeleVen</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">listado</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
                    <span class="n">listado</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="n">registro</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">listado</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">registro</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtIdVendedor</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">registro</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="c1">#ALQUILERES</span>
            <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtVendedorAlquiler</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">registro</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error cargaVendedores en cargaOneVendedor&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span></div>


<div class="viewcode-block" id="Vendedores.historicoVendedores">
<a class="viewcode-back" href="../src/vendedores.html#vendedores.Vendedores.historicoVendedores">[documentos]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">historicoVendedores</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Carga el historial de vendedores en la tabla de vendedores.</span>

<span class="sd">            Procedimiento:</span>
<span class="sd">            1. Llama a la función `cargaTablaVendedores` para cargar los datos de los vendedores en la tabla.</span>

<span class="sd">            Excepciones:</span>
<span class="sd">            - Captura y muestra cualquier excepción que ocurra durante el proceso de carga del historial de vendedores.</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">Vendedores</span><span class="o">.</span><span class="n">cargaTablaVendedores</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;checkbox historico no funciona correctamente en vendedores&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span></div>


<div class="viewcode-block" id="Vendedores.modifVendedor">
<a class="viewcode-back" href="../src/vendedores.html#vendedores.Vendedores.modifVendedor">[documentos]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">modifVendedor</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Modifica los datos de un vendedor en la base de datos y actualiza la tabla de vendedores.</span>

<span class="sd">            Procedimiento:</span>
<span class="sd">            1. Obtiene los datos del vendedor desde la interfaz de usuario.</span>
<span class="sd">            2. Verifica si la fecha de baja es válida (no puede ser anterior a la fecha de alta).</span>
<span class="sd">            3. Verifica si los campos obligatorios están completos.</span>
<span class="sd">            4. Si los campos obligatorios están completos y la fecha de baja es válida, modifica el vendedor en la base de datos.</span>
<span class="sd">            5. Si la modificación es exitosa, muestra un mensaje de confirmación y actualiza la tabla de vendedores.</span>
<span class="sd">            6. Si los campos obligatorios no están completos, muestra un mensaje de error.</span>
<span class="sd">            7. Si ocurre algún error durante el proceso, muestra un mensaje de error.</span>

<span class="sd">            Excepciones:</span>
<span class="sd">            - Captura y muestra cualquier excepción que ocurra durante el proceso de modificación del vendedor.</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">modifVendedor</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">lblIdVen</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtNomVen</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span><span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtAltaVen</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span><span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtMovilVen</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span><span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtEmailVen</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span><span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">cmbDeleVen</span><span class="o">.</span><span class="n">currentText</span><span class="p">(),</span><span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtBajaVen</span><span class="o">.</span><span class="n">text</span><span class="p">()]</span>
            <span class="k">if</span>  <span class="n">modifVendedor</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">Vendedores</span><span class="o">.</span><span class="n">esFechasValidas</span><span class="p">(</span><span class="n">modifVendedor</span><span class="p">):</span>
                <span class="n">eventos</span><span class="o">.</span><span class="n">Eventos</span><span class="o">.</span><span class="n">crearMensajeError</span><span class="p">(</span><span class="s2">&quot;Aviso&quot;</span><span class="p">,</span><span class="s2">&quot;La fecha de baja no puede anterior a la de alta.&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">Vendedores</span><span class="o">.</span><span class="n">hasCamposObligatorios</span><span class="p">(</span><span class="n">modifVendedor</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="ow">and</span> <span class="n">var</span><span class="o">.</span><span class="n">claseConexion</span><span class="o">.</span><span class="n">modifVendedor</span><span class="p">(</span><span class="n">modifVendedor</span><span class="p">):</span>
                <span class="n">eventos</span><span class="o">.</span><span class="n">Eventos</span><span class="o">.</span><span class="n">crearMensajeInfo</span><span class="p">(</span><span class="s1">&#39;Aviso&#39;</span><span class="p">,</span><span class="s2">&quot;El vendedor fue modificado correctamente en la base de datos&quot;</span><span class="p">)</span>
                <span class="n">Vendedores</span><span class="o">.</span><span class="n">cargaTablaVendedores</span><span class="p">()</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">Vendedores</span><span class="o">.</span><span class="n">hasCamposObligatorios</span><span class="p">(</span><span class="n">modifVendedor</span><span class="p">):</span>
                <span class="n">eventos</span><span class="o">.</span><span class="n">Eventos</span><span class="o">.</span><span class="n">crearMensajeError</span><span class="p">(</span><span class="s2">&quot;Error&quot;</span><span class="p">,</span><span class="s2">&quot;El vendedor no está guardado en la base de datos o bien hay campos vacíos.&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">eventos</span><span class="o">.</span><span class="n">Eventos</span><span class="o">.</span><span class="n">crearMensajeError</span><span class="p">(</span><span class="s2">&quot;Error&quot;</span><span class="p">,</span><span class="s2">&quot;Error al modificar vendedor.&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error en modifCliente&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span></div>


<div class="viewcode-block" id="Vendedores.esFechasValidas">
<a class="viewcode-back" href="../src/vendedores.html#vendedores.Vendedores.esFechasValidas">[documentos]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">esFechasValidas</span><span class="p">(</span><span class="n">datosVendedores</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Verifica si la fecha de baja es posterior a la fecha de alta.</span>

<span class="sd">            Procedimiento:</span>
<span class="sd">            1. Extrae las fechas de alta y baja de los datos del vendedor.</span>
<span class="sd">            2. Convierte las fechas de alta y baja a objetos datetime.</span>
<span class="sd">            3. Compara las fechas y retorna True si la fecha de alta es anterior a la fecha de baja, False en caso contrario.</span>

<span class="sd">            Parámetros:</span>
<span class="sd">            - datosVendedores: Lista con los datos del vendedor.</span>

<span class="sd">            Retorna:</span>
<span class="sd">            - True si la fecha de alta es anterior a la fecha de baja, False en caso contrario.</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span>

        <span class="n">datos</span> <span class="o">=</span> <span class="n">datosVendedores</span><span class="p">[:]</span>
        <span class="n">alta</span> <span class="o">=</span> <span class="n">datos</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">baja</span> <span class="o">=</span> <span class="n">datos</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>

        <span class="n">fecha_alta</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">alta</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">/%m/%Y&quot;</span><span class="p">)</span>
        <span class="n">fecha_baja</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">baja</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">/%m/%Y&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fecha_alta</span> <span class="o">&lt;</span> <span class="n">fecha_baja</span> <span class="c1">#si fecha de alta es posterior a fecha de baja devuelve false</span></div>


<div class="viewcode-block" id="Vendedores.buscaOneVendedor">
<a class="viewcode-back" href="../src/vendedores.html#vendedores.Vendedores.buscaOneVendedor">[documentos]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">buscaOneVendedor</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Busca un vendedor en la base de datos por su número de móvil y carga sus datos en la interfaz de usuario.</span>

<span class="sd">            Procedimiento:</span>
<span class="sd">            1. Obtiene el número de móvil del campo de texto correspondiente.</span>
<span class="sd">            2. Busca el vendedor en la base de datos usando el número de móvil.</span>
<span class="sd">            3. Si el vendedor existe, carga sus datos en los campos correspondientes de la interfaz de usuario.</span>
<span class="sd">            4. Si el vendedor no existe, muestra un mensaje de error.</span>

<span class="sd">            Excepciones:</span>
<span class="sd">            - Captura y muestra cualquier excepción que ocurra durante el proceso de búsqueda del vendedor.</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">movil</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtMovilVen</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">registro</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">claseConexion</span><span class="o">.</span><span class="n">datosOneVendedor</span><span class="p">(</span><span class="n">movil</span><span class="p">,</span><span class="s2">&quot;movilVendedor&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">registro</span><span class="p">:</span>
                <span class="n">listado</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">lblIdVen</span><span class="p">,</span><span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtDniVen</span><span class="p">,</span> <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtNomVen</span><span class="p">,</span> <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtAltaVen</span><span class="p">,</span> <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtBajaVen</span><span class="p">,</span>
                           <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtMovilVen</span><span class="p">,</span> <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">txtEmailVen</span><span class="p">,</span> <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">cmbDeleVen</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">listado</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
                        <span class="n">listado</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="n">registro</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">listado</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">registro</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">eventos</span><span class="o">.</span><span class="n">Eventos</span><span class="o">.</span><span class="n">crearMensajeError</span><span class="p">(</span><span class="s2">&quot;Error&quot;</span><span class="p">,</span><span class="s2">&quot;El vendedor con móvil &quot;</span><span class="o">+</span> <span class="n">movil</span> <span class="o">+</span> <span class="s2">&quot; no existe en la base de datos&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error cargaVendedores en cargaOneVendedor&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span></div>
</div>

</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">PROYECTODAM24_25</a></h1>








<h3>Navegación</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Código de módulo</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Búsqueda rápida</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Ir a" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Luis Guillermo Andre Garrido.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.4.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
    </div>

    

    
  </body>
</html>